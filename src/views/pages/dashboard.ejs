<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta http-equiv="X-UA-Compatible" content="IE=edge" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Home</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css"
			rel="stylesheet"
			integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3"
			crossorigin="anonymous"
		/>
		<link
			rel="stylesheet"
			href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.6.0/font/bootstrap-icons.css"
		/>
	</head>
	<style>
		.profile_avatar {
			max-width: 150px;
			max-height: 150px;
			position: relative;
			right: 300px;
		}
	</style>
	<body>
		<%- include('../partials/header'); -%>
		<main class="container d-flex flex-column justify-content-center align-items-left">
			<div class="container">
				<div class="row">
					<div class="col-12">
						<h3>Product List</h3>
					</div>
					<div class="col-12">
						<table class="table table-striped">
							<thead>
								<tr>
									<th scope="col">#</th>
									<th scope="col">Name</th>
									<th scope="col">Memories</th>
									<th scope="col">Colors</th>
									<th scope="col">Price</th>
									<th scope="col">Quantity</th>
									<th scope="col">Action</th>
								</tr>
							</thead>
							<tbody>
								<% products.forEach(function(product) { %>
								<tr>
									<th scope="row"><%- product._id %></th>
									<td><%- product.name %></td>
									<td><%- product.memory %></td>
									<td><%- product.colors %></td>
									<td><%- product.price %></td>
									<td><%- product.stock %></td>
									<td>
										<button
											class="btn btn-primary"
											onclick="window.location.href='/product/<%- product.id %>'"
										>
											View
										</button>
									</td>
								</tr>
								<% }); %>
							</tbody>
						</table>
					</div>
				</div>
				<div class="row">
					<div class="col-12">
						<h3>User Information</h3>
					</div>
					<div class="col-12">
						<div class="row">
							<div class="col-6">
								<h6>Name</h6>
							</div>
							<div class="col-6">
								<img
									class="profile_avatar"
									src="http://localhost:8080/public/images/avatars/profile/<%- user.email.email%>.jpg"
									alt=""
								/>
							</div>
							<div class="col-12">
								<p><%- user.name %></p>
							</div>
						</div>
						<div class="row">
							<div class="col-12">
								<h6>Last Name</h6>
							</div>
							<div class="col-12">
								<p><%- user.lastName %></p>
							</div>
						</div>
						<div class="row">
							<div class="col-12">
								<h6>Email</h6>
							</div>
							<div class="col-12">
								<p><%- user.email.email %></p>
							</div>
						</div>
					</div>
				</div>
				<% if (cartProducts !== null) { %>
				<div class="row">
					<div class="col-12">
						<h3>User's Cart</h3>
					</div>
					<div class="col-12">
						<table class="table table-striped">
							<thead>
								<tr>
									<th scope="col">#</th>
									<th scope="col">Name</th>
									<th scope="col">Memory</th>
									<th scope="col">Color</th>
									<th scope="col">Price</th>
									<th scope="col">Quantity</th>
									<th scope="col">Action</th>
								</tr>
							</thead>
							<tbody>
								<% cartProducts.forEach(function(product) { %>
								<tr>
									<th scope="row"><%- product._id %></th>
									<td><%- product.name %></td>
									<td><%- product.memory %></td>
									<td><%- product.color %></td>
									<td><%- product.price %></td>
									<td><%- product.amount %></td>
									<td>
										<button
											class="btn btn-primary"
											onclick="window.location.href='/api/products/<%- product._id %>'"
										>
											View
										</button>
									</td>
								</tr>
								<% }) %>
							</tbody>
						</table>
					</div>
				</div>
				<% } %>
				<div class="row">
					<% if (cartId !== null) { %>
						<div class="col-2">
							<h5>Checkout Car</h5>
							<form
								action="/api/carts/<%- cartId%>/checkout/<%- user._id %>"
								method="POST"
							>
								<input
									type="submit"
									class="btn btn-primary"
									placeholder="Checkout Cart"
								/>
							</form>
						</div>
					<% } %>
					<div class="col-2">
						<h5>Logout</h5>
						<form
							action="/auth/logout"
							method="GET"
						>
							<input type="submit" class="btn btn-primary" placeholder="Logout" />
						</form>
					</div>
				</div>
			</div>
		</main>
		<script>
			document.getElementById('logoutButton').addEventListener('click', function () {
				window.location.href = '/auth/logout';
			});
		</script>
		<script
			src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"
			integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p"
			crossorigin="anonymous"
		></script>
	</body>
</html>
